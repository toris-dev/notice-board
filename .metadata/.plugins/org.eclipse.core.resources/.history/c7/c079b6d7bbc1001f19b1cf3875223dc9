-- SAMPLE 테이블 생성
CREATE MEMORY TABLE SAMPLE (
    ID VARCHAR(16) NOT NULL PRIMARY KEY, -- SAMPLE ID
    NAME VARCHAR(50),                    -- 이름
    DESCRIPTION VARCHAR(100),            -- 설명
    USE_YN CHAR(1),                      -- 사용 여부 (Y/N)
    REG_USER VARCHAR(10)                 -- 등록자
);

-- COMMENTS 테이블 생성
CREATE MEMORY TABLE COMMENTS (
    COMMENT_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT, -- 댓글 ID
    SAMPLE_ID VARCHAR(16) NOT NULL,                        -- SAMPLE의 ID
    COMMENT_TEXT VARCHAR(255) NOT NULL,                    -- 댓글 내용
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,        -- 댓글 생성 시간
    FOREIGN KEY (SAMPLE_ID) REFERENCES SAMPLE(ID)          -- 외래 키 설정
);

-- IDS 테이블 생성 (자동 증가 ID 관리)
CREATE MEMORY TABLE IDS (
    TABLE_NAME VARCHAR(16) NOT NULL PRIMARY KEY,           -- 테이블 이름
    NEXT_ID BIGINT NOT NULL                                -- 다음 ID 값
);

-- 예시: IDS 테이블에 초기값 삽입 (SAMPLE과 COMMENTS 테이블의 ID 관리)
INSERT INTO IDS (TABLE_NAME, NEXT_ID) VALUES ('SAMPLE', 1);
INSERT INTO IDS (TABLE_NAME, NEXT_ID) VALUES ('COMMENTS', 1);

-- SCHEMA 설정 (PUBLIC 스키마를 사용한다고 가정)
SET SCHEMA PUBLIC;
INSERT INTO SAMPLE VALUES('SAMPLE-00001','Runtime Environment','Foundation Layer','Y','eGov')
INSERT INTO SAMPLE VALUES('SAMPLE-00002','Runtime Environment','Persistence Layer','Y','eGov')
INSERT INTO SAMPLE VALUES('SAMPLE-00003','Runtime Environment','Presentation Layer','Y','eGov')
INSERT INTO SAMPLE VALUES('SAMPLE-00004','Runtime Environment','Business Layer','Y','eGov')

-- SAMPLE 테이블에 데이터 삽입 예시
INSERT INTO SAMPLE (ID, NAME, DESCRIPTION, USE_YN, REG_USER) 
VALUES 
    ('SAMPLE-00001', 'Runtime Environment', 'Foundation Layer', 'Y', 'admin'),
    ('SAMPLE-00002', 'Database Configuration', 'DB 설정 방법', 'Y', 'admin'),
    ('SAMPLE-00003', 'API Integration', 'API 통합 방법', 'Y', 'admin'),
    ('SAMPLE-00004', 'Security Setup', '보안 설정 방법', 'Y', 'admin');

-- COMMENTS 테이블에 댓글 데이터 삽입
INSERT INTO COMMENTS (SAMPLE_ID, COMMENT_TEXT) 
VALUES 
    ('SAMPLE-00001', '이 샘플은 실행 환경을 설정하는 데 사용됩니다.'),
    ('SAMPLE-00001', '환경 설정에 대해 더 알고 싶어요.'),
    ('SAMPLE-00001', '기본 설정은 무엇인가요?'),
    ('SAMPLE-00002', 'DB 설정을 쉽게 할 수 있는 방법이 궁금해요.'),
    ('SAMPLE-00002', '데이터베이스는 어떤 종류를 지원하나요?'),
    ('SAMPLE-00002', '연결 오류가 발생했어요, 해결 방법을 알고 싶어요.'),
    ('SAMPLE-00003', 'API 통합을 위한 첫 단계가 무엇인가요?'),
    ('SAMPLE-00003', '이 API는 어떤 인증 방식을 사용하나요?'),
    ('SAMPLE-00003', '통합 후, API 성능은 어떻게 최적화되나요?'),
    ('SAMPLE-00004', '보안 설정을 강화하려면 어떤 조치를 취해야 하나요?'),
    ('SAMPLE-00004', '2단계 인증을 설정하는 방법은 무엇인가요?'),
    ('SAMPLE-00004', '내부 네트워크 보안을 강화하는 방법에 대해 알고 싶어요.');

-- SAMPLE 데이터 삽입
INSERT INTO SAMPLE (ID, NAME, DESCRIPTION, USE_YN, REG_USER) 
VALUES 
    ('SAMPLE-00005', 'Runtime Environment', 'Batch Layer', 'Y', 'eGov');

-- SAMPLE_ID가 SAMPLE-00005인 댓글 추가
INSERT INTO COMMENTS (SAMPLE_ID, COMMENT_TEXT) 
VALUES 
    ('SAMPLE-00005', 'Batch 환경 설정에 대해 알고 싶어요.');
-- 중복된 데이터 업데이트로 대체
MERGE INTO IDS KEY(TABLE_NAME)
VALUES ('SAMPLE', 115);
INSERT INTO IDS VALUES('SAMPLE',115)


